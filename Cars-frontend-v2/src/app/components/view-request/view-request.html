<div class="dashboard-layout">
  <!-- Sidebar -->
  <nav class="sidebar" [class.collapsed]="sidebarCollapsed">
    <!-- Toggle Button -->
    <div class="sidebar-header">
      <i
        class="fa-solid toggle-arrow"
        [ngClass]="{
          'fa-arrow-left': !sidebarCollapsed,
          'fa-arrow-right': sidebarCollapsed
        }"
        (click)="toggleSidebar()"
      ></i>
    </div>

    <!-- Sidebar top section -->
    <div class="sidebar-top">
      <h6 class="all-requests-title">ALL REQUESTS</h6>
      <div class="sidebar-divider"></div>
    </div>

    <!-- Scrollable request list -->
    <div class="sidebar-scroll">
      <ul class="request-list">
        <li
          *ngFor="let request of requests"
          class="request-item"
          [class.active]="request.active"
        >
          <div
            class="request-title"
            (click)="toggleRequest(request)"
            [class.active]="request.active"
          >
            <img
              [src]="'assets/icons/' + getStatusIconFileName(request.status)"
              alt="{{ request.status }} icon"
              class="status-icon"
            />
            <span
              class="request-name"
              [matTooltip]="request.name"
              matTooltipPosition="right"
            >
              {{ request.name }}
            </span>
            <span class="arrow" *ngIf="request.sections?.length">
              <i
                class="fa"
                [ngClass]="{
                  'fa-chevron-down': request.expanded,
                  'fa-chevron-right': !request.expanded
                }"
              ></i>
            </span>
          </div>

          <ul class="section-list" *ngIf="request.expanded">
            <li
              *ngFor="let section of request.sections"
              class="section-item"
              [class.active]="section.active"
            >
              <div
                class="section-title"
                (click)="
                  toggleSection(request, section); $event.stopPropagation()
                "
                [class.active]="section.active"
              >
                <span class="section-dot"></span>
                {{ section.name }}
                <span class="arrow" *ngIf="section.children?.length">
                  <i
                    class="fa"
                    [ngClass]="{
                      'fa-chevron-down': section.expanded,
                      'fa-chevron-right': !section.expanded
                    }"
                  ></i>
                </span>
              </div>

              <ul class="subsection-list" *ngIf="section.expanded">
                <li
                  *ngFor="let subsection of section.children"
                  class="subsection-item"
                  [class.active]="subsection.active"
                  (click)="
                    selectSubsection(request.id, section.id, subsection.id);
                    $event.stopPropagation()
                  "
                >
                  {{ subsection.name }}
                </li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </div>
  </nav>

  <!-- Main content area -->
  <main class="main-content" [class.full-width]="sidebarCollapsed">
    <div class="illustration-container" *ngIf="showIllustration">
      <img src="assets/icons/work_in_progress.svg" alt="Illustration" />
    </div>
    <router-outlet></router-outlet>
  </main>
</div>
